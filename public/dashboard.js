var products = [
  {
    product_id: 1,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115.0,
    img_url:
      "https://wpbingosite.com/wordpress/favita/wp-content/uploads/2018/10/Image-41-720x960.jpg",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 2,
    product_title: "Armani Panel Blue Jean",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 20.5,
    img_url:
      "https://wpbingosite.com/wordpress/favita/wp-content/uploads/2018/10/Image-2-720x960.jpg",
    vendor: "Armani Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 3,
    product_title: "Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 20.3,
    img_url:
      "https://wpbingosite.com/wordpress/favita/wp-content/uploads/2018/10/Image-41-720x960.jpg",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 4,
    product_title: "DeFacto Sneakers",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 30,
    img_url:
      "https://wpbingosite.com/wordpress/favita/wp-content/uploads/2019/03/Image-16-720x960.jpg",
    vendor: "Defacto",
    categories: "generic",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 5,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115,
    img_url:
      "https://wpbingosite.com/wordpress/favita/wp-content/uploads/2019/03/Image-26-720x960.jpg",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 6,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115,
    img_url:
      "https://wpbingosite.com/wordpress/favita/wp-content/uploads/2019/03/Image-10-720x960.jpg",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 7,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115,
    img_url:
      "https://wpbingosite.com/wordpress/favita/wp-content/uploads/2018/10/Image-34-720x960.jpg",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 8,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115,
    img_url:
      "https://wpbingosite.com/wordpress/favita/wp-content/uploads/2019/03/Image-3-720x960.jpg",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 9,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115,
    img_url:
      "https://wpbingosite.com/wordpress/favita/wp-content/uploads/2019/03/Image-45-720x960.jpg",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 10,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115,
    img_url:
      "https://wpbingosite.com/wordpress/favita/wp-content/uploads/2019/03/Image-26-720x960.jpg",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 11,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115,
    img_url:
      "https://wpbingosite.com/wordpress/favita/wp-content/uploads/2019/03/Image-10-720x960.jpg",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 12,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115.0,
    img_url: "/kira1.png",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 13,
    product_title: "Armani Panel Blue Jean",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 20.5,
    img_url: "/kira2.png",
    vendor: "nodemani Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 14,
    product_title: "Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 20.3,
    img_url: "/kira3.png",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 15,
    product_title: "DeFacto Sneakers",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 30,
    img_url: "/kira4.png",
    vendor: "Defacto",
    categories: "generic",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 16,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115,
    img_url: "/kira5.png",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 17,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115,
    img_url: "/kira6.png",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 18,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115,
    img_url: "/kira7.png",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 19,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115,
    img_url: "/kira8.png",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
  {
    product_id: 20,
    product_title: "Armani Black Suit Default",
    product_description:
      "Your perfect pack for everyday use and walks in the forest. Stash your laptop (up to 15 inches) in the padded sleeve, your everyday",
    price: 115,
    img_url: "/kira9.png",
    vendor: "Kira Coutoure",
    categories: "women",
    liked: { like_status: false, count: 30 },
  },
];
var settings = {
  async: true,
  crossDomain: true,
  url: "https://kiradb-4408.restdb.io/rest/kiras",
  method: "GET",
  headers: {
    "content-type": "application/json",
    "x-apikey": "63443556626b9c747864aaf1",
    "cache-control": "no-cache",
  },
};

$.ajax(settings).done(function (response) {
  console.log(response);
  products = response;
  var productRend = document.getElementById("product_catalogs");

  products.map((item, i) => {
    const ordered = document.createElement("div");
    ordered.className = "product_contain";
    ordered.id = "product" + item.product_id;
    const newProduct = `
       <div class="products" >
      <img src="${item.img_url}" alt="">
      
    </div>
    <h4>${item.product_title}</h4>
      <p>$${item.price}</p>
      <div class="delete_edit"> <button class="btn_edit-admin"  onclick="showThis(5, {'b': '${item._id}'})" ><i class="fa-solid fa-pen"></i> Edit </button> <button class="btn_delete-admin" id="${item._id}" onclick="deleteProd(this.id)"><i class="fa-solid fa-trash"></i> Delete </button></div>
  
  `;
    ordered.innerHTML = newProduct;
    productRend.append(ordered);
  });

  // console.log(body);
});

function showThis(n, b) {
  if (n === 2) {
    document.getElementById("product_catalogs").style.display = "none";
    document.getElementById("blog_catalogs").style.display = "flex";
    document.getElementById("addProd").style.display = "none";
    document.getElementById("createBlog").style.display = "none";
  } else if (n === 1) {
    document.getElementById("product_catalogs").style.display = "flex";
    document.getElementById("createBlog").style.display = "none";
    document.getElementById("blog_catalogs").style.display = "none";
    document.getElementById("addProd").style.display = "none";
  } else if (n === 4) {
    document.getElementById("product_catalogs").style.display = "none";
    document.getElementById("blog_catalogs").style.display = "none";
    document.getElementById("addProd").style.display = "block";
    document.getElementById("createProd").style.display = "block";
    document.getElementById("edit_product").style.display = "none";
    document.getElementById("createBlog").style.display = "none";
  } else if (n === 5) {
    document.getElementById("product_catalogs").style.display = "none";
    document.getElementById("blog_catalogs").style.display = "none";
    document.getElementById("addProd").style.display = "block";
    document.getElementById("createProd").style.display = "none";
    document.getElementById("edit_product").style.display = "block";
    document.getElementById("createBlog").style.display = "none";
    document.getElementById("editingId").value = b.b;
    console.log(n + " now " + b.b);
  } else if (n === 7) {
    document.getElementById("product_catalogs").style.display = "none";
    document.getElementById("blog_catalogs").style.display = "none";
    document.getElementById("createBlog").style.display = "block";
    document.getElementById("addProd").style.display = "none";
    document.getElementById("createProd").style.display = "none";
    document.getElementById("edit_product").style.display = "none";
  } else {
    console.log(n);
  }
}
function editProd() {
  var formData = new FormData();

  formData.append("_Id", document.getElementById("editingId").value);
  formData.append("fileupload", fileupload.files[0]);
  formData.append(
    "product_title",
    document.getElementById("productTitleId").value
  );
  formData.append(
    "product_description",
    document.getElementById("productDescId").value
  );
  formData.append(
    "price",
    parseInt(document.getElementById("producPriceId").value)
  );
  formData.append(
    "categories",
    document.getElementById("productCategoryId").value
  );
  formData.append("vendor", "Kira Coutoure");

  console.log("edit log " + formData);
  fetch("http://localhost:3000/putproduct", {
    method: "POST",
    body: formData,
  }).then(function (response) {
    if (response.status === 200) {
      alert("Edit Successful");
      redirect_url = "/login";
      location.href = redirect_url;
    } else {
      alert(
        "There was a problem sending your cv. Please Email us with complaint at cv@remedyportal.com"
      );
    }
  });
}
function deleteProd(clicked_id) {
  var info = { id: clicked_id };
  $.ajax({
    type: "POST",
    url: "/deleteproduct",
    headers: { _id: clicked_id },
    data: JSON.stringify(info),
    success: function () {
      // Success Page
      redirect_url = "/login";
      location.href = redirect_url;
    },
    error: function (data) {
      console.log(data);
    },
    dataType: "json",
    contentType: "application/json",
  });
}

// BLOG POST ///////////////

async function postBlog() {
  var formData = new FormData();

  // formData.append("fileupload", fileupload.files[0]);
  formData.append("post_title", document.getElementById("blogTitleId").value);
  formData.append(
    "post_description",
    document.getElementById("blogDescId").value
  );
  formData.append("blogImg", blogImg.files[0]);
  formData.append("author", document.getElementById("authorId").value);

  console.log("edit log " + formData);
  await fetch("http://localhost:3000/postblog", {
    method: "POST",
    body: formData,
  }).then(function (response) {
    if (response.status === 200) {
      alert("pst successful Successful");
      // redirect_url = "/login";
      // location.href = redirect_url;
      console.log("form submitted");
    } else {
      alert(
        "There was a problem sending your cv. Please Email us with complaint at cv@remedyportal.com"
      );
    }
  });
}

// DELETE BLOG ///////////

function deleteBlog(clicked_id) {
  var info = { id: clicked_id };
  $.ajax({
    type: "POST",
    url: "/deleteproduct",
    headers: { _id: clicked_id },
    data: JSON.stringify(info),
    success: function () {
      // Success Page
      redirect_url = "/login";
      location.href = redirect_url;
    },
    error: function (data) {
      console.log(data);
    },
    dataType: "json",
    contentType: "application/json",
  });
}
